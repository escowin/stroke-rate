# Recharts X-Axis Tick and Scaling Difficulties

This document outlines the challenges encountered when attempting to achieve precise control over X-axis ticks and visual scaling in the Recharts library. These issues suggest potential limitations or complexities that may warrant consideration for alternative charting libraries in future development.

## Problem Statement

The primary goal was to display X-axis ticks at evenly spaced quarter intervals (0%, 25%, 50%, 75%, 100%) of the session duration, ensuring that these ticks were both numerically accurate and visually evenly distributed across the chart's width.

## Issues Encountered

### 1. Automatic Tick Filtering/Spacing
- Recharts' default behavior often filters out ticks that it deems too close together or when the `tickCount` is not explicitly set or conflicts with other properties.
- Even when providing a custom `ticks` array, Recharts would frequently omit certain labels (e.g., the 50% mark for a 61-second session, which was calculated as 31s).

### 2. Conflicting Properties
- Attempts to force all ticks to display using `tickCount={xAxisTicks.length}` and `interval={0}` often led to an excessive number of ticks being generated by Recharts, or still resulted in some custom ticks not being labeled.
- The `domain` property, while essential for setting the axis range, did not inherently guarantee even visual distribution when combined with custom ticks.

### 3. `tickFormatter` Limitations
- While a `tickFormatter` can be used to selectively display labels for specific values, it does not prevent Recharts from generating the underlying tick *positions*. If Recharts' internal scaling is uneven, the visual distribution remains problematic, even if only desired labels are shown.
- Using `tickFormatter` to hide unwanted ticks (by returning an empty string) still resulted in the underlying tick lines being drawn, leading to a cluttered appearance if Recharts generated many unwanted ticks.

### 4. Uneven Visual Distribution
- The most significant issue was the visual distortion of the X-axis. Despite the data points being correctly mapped to their `duration` values, the chart's rendering engine did not consistently map equal time intervals to equal physical space on the screen. For example, the first 15 seconds might occupy a much larger visual segment than the last 15 seconds of a session. This makes visual analysis of performance across different quarters of the session inaccurate and misleading.
- This suggests an underlying issue with how Recharts handles the `scale` of the XAxis when `dataKey` is used, or when the data itself is not perfectly continuous or uniformly distributed in terms of `duration` values.

### 5. Lack of Direct Control over Visual Scaling
- Recharts provides `scale` properties (e.g., `scale="time"`, `scale="linear"`), but these did not consistently resolve the visual unevenness when combined with custom `ticks` or `dataKey` mapping. The library seems to prioritize fitting the data points rather than strictly adhering to a linear visual representation of the time axis.

### 6. Custom Tick Component Issues
- Creating a custom tick component (`CustomXAxisTick`) that selectively renders only desired tick labels still resulted in uneven visual distribution, as the underlying tick positions were still determined by Recharts' internal scaling logic.

## Attempted Solutions

1. **Custom Ticks Array**: Providing a precise array of quarter-based tick values
2. **Tick Count and Interval Control**: Using `tickCount` and `interval` properties to force display
3. **Custom Tick Formatter**: Filtering which ticks get labels while allowing all positions
4. **Custom Tick Component**: Complete control over tick rendering
5. **Linear Scale**: Explicitly setting `scale="linear"` on the XAxis
6. **Domain Control**: Setting explicit domain ranges from 0 to session duration

## Current Status

**RESOLVED**: The issues have been successfully resolved by implementing the following solution:

- **Domain Control**: Changed from `domain={['dataMin', 'dataMax']}` to `domain={[0, sessionDuration]}` to set an explicit linear range
- **Linear Scale**: Added `scale="linear"` property to force even visual distribution
- **Simplified Configuration**: Removed conflicting properties like `tickCount` and `interval` that were interfering with tick display

This solution successfully achieved:
1. **Even Visual Distribution**: Time intervals now map evenly to visual space on the x-axis
2. **Complete Tick Display**: All calculated quarter ticks (0, 15, 31, 46, 61 for a 61-second session) are now properly displayed
3. **Linear Scaling**: The chart now accurately represents time progression with consistent visual spacing

The key insight was that Recharts' default `domain={['dataMin', 'dataMax']}` was causing uneven scaling, and the explicit `domain={[0, sessionDuration]}` combined with `scale="linear"` provided the necessary control over the axis rendering.

## Successful Solution

The key to resolving these issues was understanding that Recharts' default behavior with `domain={['dataMin', 'dataMax']}` was causing the scaling problems. The solution involved:

```tsx
<XAxis
  dataKey="duration"
  domain={[0, sessionDuration]} // Explicit linear domain
  scale="linear" // Force linear scaling
  ticks={xAxisTicks} // Custom quarter-based ticks
  // ... other props
/>
```

This approach provides the necessary control over axis rendering while working within Recharts' architecture.

## Recommendations for Future Development

1. **Use Explicit Domains**: Always set explicit `domain` values for time-series data rather than relying on `['dataMin', 'dataMax']`
2. **Specify Scale Type**: Explicitly set `scale="linear"` for time-based axes to ensure even visual distribution
3. **Avoid Conflicting Properties**: Don't mix `tickCount`, `interval`, and custom `ticks` arrays as they can interfere with each other
4. **Test with Various Data Distributions**: Ensure the solution works with both sparse and dense data point distributions

## Conclusion

While Recharts initially presented challenges with precise control over X-axis ticks and scaling, the issues were resolved through proper configuration of the `domain` and `scale` properties. The library can provide the necessary control for time-series data visualization when configured correctly. This experience highlights the importance of understanding the underlying scaling behavior of charting libraries and the impact of default domain settings.
