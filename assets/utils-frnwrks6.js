import{R as l}from"./charts-Br66VyBn.js";const g=e=>{let t;const n=new Set,r=(c,S)=>{const f=typeof c=="function"?c(t):c;if(!Object.is(f,t)){const O=t;t=S??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(V=>V(t,O))}},s=()=>t,u={setState:r,getState:s,getInitialState:()=>i,subscribe:c=>(n.add(c),()=>n.delete(c))},i=t=e(r,s,u);return u},T=(e=>e?g(e):g),v=e=>e;function A(e,t=v){const n=l.useSyncExternalStore(e.subscribe,l.useCallback(()=>t(e.getState()),[e,t]),l.useCallback(()=>t(e.getInitialState()),[e,t]));return l.useDebugValue(n),n}const k=e=>{const t=T(e),n=r=>A(t,r);return Object.assign(n,t),n},U=(e=>k),b=(e,t)=>t.some(n=>e instanceof n);let E,M;function p(){return E||(E=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function W(){return M||(M=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const m=new WeakMap,h=new WeakMap,I=new WeakMap;function F(e){const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("success",a),e.removeEventListener("error",o)},a=()=>{n(d(e.result)),s()},o=()=>{r(e.error),s()};e.addEventListener("success",a),e.addEventListener("error",o)});return I.set(t,e),t}function R(e){if(m.has(e))return;const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",o),e.removeEventListener("abort",o)},a=()=>{n(),s()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",a),e.addEventListener("error",o),e.addEventListener("abort",o)});m.set(e,t)}let D={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return m.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return d(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function x(e){D=e(D)}function K(e){return W().includes(e)?function(...t){return e.apply(w(this),t),d(this.request)}:function(...t){return d(e.apply(w(this),t))}}function N(e){return typeof e=="function"?K(e):(e instanceof IDBTransaction&&R(e),b(e,p())?new Proxy(e,D):e)}function d(e){if(e instanceof IDBRequest)return F(e);if(h.has(e))return h.get(e);const t=N(e);return t!==e&&(h.set(e,t),I.set(t,e)),t}const w=e=>I.get(e);function X(e,t,{blocked:n,upgrade:r,blocking:s,terminated:a}={}){const o=indexedDB.open(e,t),u=d(o);return r&&o.addEventListener("upgradeneeded",i=>{r(d(o.result),i.oldVersion,i.newVersion,d(o.transaction),i)}),n&&o.addEventListener("blocked",i=>n(i.oldVersion,i.newVersion,i)),u.then(i=>{a&&i.addEventListener("close",()=>a()),s&&i.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),u}const $=["get","getKey","getAll","getAllKeys","count"],z=["put","add","delete","clear"],y=new Map;function P(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(y.get(t))return y.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=z.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||$.includes(n)))return;const a=async function(o,...u){const i=this.transaction(o,s?"readwrite":"readonly");let c=i.store;return r&&(c=c.index(u.shift())),(await Promise.all([c[n](...u),s&&i.done]))[0]};return y.set(t,a),a}x(e=>({...e,get:(t,n,r)=>P(t,n)||e.get(t,n,r),has:(t,n)=>!!P(t,n)||e.has(t,n)}));const G=["continue","continuePrimaryKey","advance"],C={},B=new WeakMap,j=new WeakMap,H={get(e,t){if(!G.includes(t))return e[t];let n=C[t];return n||(n=C[t]=function(...r){B.set(this,j.get(this)[t](...r))}),n}};async function*J(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const n=new Proxy(t,H);for(j.set(n,t),I.set(n,w(t));t;)yield n,t=await(B.get(n)||t.continue()),B.delete(n)}function L(e,t){return t===Symbol.asyncIterator&&b(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&b(e,[IDBIndex,IDBObjectStore])}x(e=>({...e,get(t,n,r){return L(t,n)?J:e.get(t,n,r)},has(t,n){return L(t,n)||e.has(t,n)}}));export{U as c,X as o};
